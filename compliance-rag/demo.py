# demo.py
import os
from src.rag_engine import ComplianceRAGEngine

os.environ["DASHSCOPE_API_KEY"] = "sk-2061ea9f55e446ffa570d8ac2510d401"

if __name__ == "__main__":
    engine = ComplianceRAGEngine()

    test_cases = [
    # 1. 承诺收益表述
    "这款产品稳赚不赔，年化收益保底8%！",
    "客户问：能保证赚钱吗？我们回答：不能，历史业绩不代表未来收益。",

    # 2. 对投研调研活动夸大宣传
    "我们这次调研拿到了一手资料，对这家公司知根知底！",
    "本周安排了上市公司实地调研，欢迎参与。",

    # 3. 与客户进行私下联系
    "你微信号多少？我加你个人微信发策略。",
    "请通过官网 abctougu.com 填写信息获取服务。",

    # 4. 使用敏感词汇
    "这个票是妖股，下周冲击连板，翻倍不是梦！",
    "市场有机会反弹，建议关注基本面良好的标的。",

    # 5. 短期内可获高额回报表述
    "10天赚10万，加入我们马上行动！",
    "周一【热点抢先机】低价解锁模型选股工具试试？",

    # 6. 异常开户（FX）
    "通过华泰证券开户，最低佣金，加他微信办理。",
    "我平时用中信证券交易，体验不错。",

    # 7. 干扰风险测评独立性
    "你就选C，这样能买高风险产品。",
    "请自行完成风险测评，不要随便选。",

    # 8. 错误表述服务合同生效起始周期
    "服务期限从明天开始计算，请放心。",
    "办好手续后，明天就能跟上操作。",

    # 9. 低投入高额回报表述
    "5万本金，轻松赚8万，收益率超100%！",
    "该产品历史年化收益约15%，仅供参考。",

    # 10. 不文明用语
    "你这种客户真难搞，傻逼！",
    "这个操作有点离谱，麻烦再确认一下。",

    # 11. 以退款为营销卖点
    "不满意就退，5天内全额退款，放心下单！",
    "退款需提交申请并经审批，详情见政策说明。",

    # 12. 怂恿客户使用他人身份办理服务
    "用你爱人身份办理，信息发到这个微信就行。",
    "请本人持身份证办理服务，谢谢配合。",

    # 13. 违规指导
    "明天开盘直接买入XX股票，目标15元止盈。",
    "根据投资顾问执业编号S123456的策略，建议在支撑位低吸。",

    # 14. 对标个股未来走势
    "这只票肯定会涨，跟上就对了，冲击涨停没问题！",
    "该股过去一周上涨20%，已进入高位震荡阶段。"
]
    
    for i, text in enumerate(test_cases, 1):
        print(f"{'='*60}")
        print(f"案例 {i:2d}: {text}")
        result = engine.predict(text)
        print(f"违规: {'是' if result['violation'] else '否'}")
        print(f"触发事件: {result['triggered_event']}")
        print(f"理由: {result['reason']}")
        print()